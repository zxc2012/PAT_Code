# CS162 Lecture2 --Threads and Processes

## Process Management API
pthread: posix(portable operating system interface)
- join(pid) - suspends execution of the calling thread until the target *pid* terminates 
- exit – terminate a process
- fork – copy the current process
    - $>0$: Returned to parent or caller,return value is pid of new child
    - $=0$: Returned to the newly created child process
    - $<0$: error creating,running in original process
- exec – change the program being run by the current process
- wait –  pauses the parent until the child finishes,crashes, or is terminated
    ```c
    int main(int argc, char* argv[]){
        pid_t cpid,tcpid;
        cpid = fork();
        int status;
        pid_t mypid=getpid();
        if (cpid > 0) {               /* Parent Process */
            tcpid = wait(&status);
            printf("%d wait%d(%d)",mypid,tcpid,status);
        } else if (cpid == 0) {      /* Child Process */
            mypid = getpid();
            printf("[%d] child\n", mypid);
            exit(1);
        }
    }
    ```
    output:

    > [8042] child

    > 8041 wait8042(256)
- kill – send a signal (interrupt-like notification) to another process
- sigaction – set handlers for signals


Main thread creates (forks) collection of sub-threads passing them args to work on, and then *join*s with them, collecting results

![20220120162550](https://raw.githubusercontent.com/zxc2012/image/main/20220120162550.png)

## Lock
semaphore ['sɛməfɔr]`sema- :signal,phoro:carry,bring`

