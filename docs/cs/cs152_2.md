# CS152 Lecture2 --Complex Pipelining

## Basic

### Advanced Data Hazard

Out-of-order write hazards due to variable latencies of different functional units(FDIV,FMUL takes more than one cycle)

![20220513105012](https://raw.githubusercontent.com/zxc2012/image/main/20220513105012.png)

### In-order and Out-of-order

RAW(red) WAR(purple) WAW(green)

![20220513105012](https://raw.githubusercontent.com/zxc2012/image/main/20220513112822.png)

regrardless of WAR, look for what can be fetched next(dependency), if empty finish execute waiting instruction

![20220513105012](https://raw.githubusercontent.com/zxc2012/image/main/20220513120540.png)

### Table for Correct Issue

![20220519214047](https://raw.githubusercontent.com/zxc2012/image/main/20220519214047.png)

## Scoreboard

### In-order

Assuming: Suppose the instruction is not issued	by the Issue stage if a RAW	hazard exists or the required FU is busy,and that operands are registered by functional unit on issue

- NO WAR: Earlier instructions read	their operands at issue
    - no need to keep src1 and src2
- still WAW	hazard: e.g. Out-of-order completion
    - WP[reg#],a bit-vector to record the registers for which writes are pending(cleared after WB stage)
    - Busy[FU#],a bit-vector to	indicate FUâ€™s availability(FU=	Int,Add,Mult,Div)

Lookup:

- FU available?	*Busy[FU#]*
- RAW? *WP[src1] or WP[src2]*
- WAW? *WP[dest]*		

Example

Diagnol means pipeline

![20220519214902](https://raw.githubusercontent.com/zxc2012/image/main/20220519214902.png)
